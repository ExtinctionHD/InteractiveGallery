#version 450

layout (local_size_x = 8, local_size_y = 8) in;

layout (set = 0, binding = 0) uniform sampler2D hdrImage;
layout (set = 1, binding = 0, rgba8) uniform image2D resultImage;

const float EXPOSURE = 1.0f;

void main()
{	
	vec3 hdrColor = texelFetch(hdrImage, ivec2(gl_GlobalInvocationID.xy), 0).rgb;

	vec3 result = vec3(1.0f) - exp(-hdrColor * EXPOSURE);

	imageStore(resultImage, ivec2(gl_GlobalInvocationID.xy), vec4(result, 1.0f));
}
